generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
model Client {
  id        Int      @id @default(autoincrement())
  name      String
  logoUrl   String?  // optional; store full CDN/hosted url
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model LeteiOnePage {
  id           Int      @id @default(autoincrement())
  slug         String   @unique
  title        String
  description  String
  url          String?
  image        String?
  keywords     String[] @default([])
  features     Json?
  integrations String[] @default([])
  useCases     Json?
  faq          Json?
  metrics      Json?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  protected    Boolean  @default(false)
}
model NewsletterSubscription {
  id             Int              @id @default(autoincrement())
  name           String?
  email          String           @unique
  phone          String?
  userAgent      String?
  ip             String?
  idempotencyKey String?          @unique
  messageId      String?          @unique
  privacyConsent Boolean          @default(false)
  status         SubmissionStatus @default(PENDING)
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt

  @@index([createdAt])
}

model LeteiSpacePage {
  id             Int      @id @default(autoincrement())
  slug           String   @unique
  title          String
  subtitle       String?
  description    String?
  hero           Json?      // matches HeroProps
  plans          Json?      // array of PricingPlan
  integrations   Json?      // array of Integration
  whyChoose      Json?      // WhyChooseLeteiSpaceItem[]
  faq            Json?      // FAQItem[]
  testimonials   Json?      // Testimonial[]
  features       Json?      // Feature[]
  technicalNotes Json?      // TechnicalNote[]
  trustedMetrics Json?      // TrustedMetric[]
  cta            Json?
  seo            Json?
  currency       String?
  conversionRate Float?
  published      Boolean   @default(false)
  publishedAt    DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  @@index([createdAt])
}

model CaseStudy {
  id          String    @id @default(cuid())
  slug        String    @unique
  client      String
  sector      String
  timeline    String?
  startDate   DateTime?
  endDate     DateTime?
  readTime    Int?
  short       String?
  problem     String
  approach    String?
  solution    String
  results     Json?
  metrics     Json?
  platforms   String[]  @default([])
  tags        String[]  @default([])
  featured    Boolean   @default(false)
  quote       Json?
  team        Json?
  techStack   String[]  @default([])
  resources   Json?
  seo         Json?
  images      Json?
  draft       Boolean   @default(false)
  publishedAt DateTime?
  updatedAt   DateTime  @updatedAt
  createdAt   DateTime  @default(now())
  clientLogo  Json?
  hero        Json?
  url         String?
}

model SocialLink {
  id     Int         @id @default(autoincrement())
  kind   SocialKind
  url    String
  pageId Int
  page   ContactPage @relation(fields: [pageId], references: [id])
}

model ContactPage {
  id          Int          @id @default(autoincrement())
  title       String
  subtitle    String?
  description String?
  phone       String?
  email       String?
  location    String?
  faqs        Json?
  seo         Json?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  socials     SocialLink[]
}

model ContactSubmission {
  id             Int            @id @default(autoincrement())
  name           String
  email          String
  org            String?
  message        String
  userAgent      String?
  ip             String?
  createdAt      DateTime       @default(now())
  messageId      String?
  privacyConsent Boolean        @default(false)
  deletedAt      DateTime?
  replies        ContactReply[]
}

model ContactReply {
  id                  Int               @id @default(autoincrement())
  contactSubmissionId Int
  message             String
  sentAt              DateTime          @default(now())
  messageId           String?
  deletedAt           DateTime?
  contactSubmission   ContactSubmission @relation(fields: [contactSubmissionId], references: [id], onDelete: Cascade)
}

model PricingPage {
  id             Int               @id @default(autoincrement())
  title          String
  subtitle       String?
  description    String?
  heroImage      String?
  keywords       String[]          @default([])
  cta            Json?
  seo            Json?
  faq            Json?
  published      Boolean           @default(false)
  publishedAt    DateTime?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  payments       PaymentMethod[]
  offerings      PricingTier[]
  quickEstimates QuickEstimate[]
  whyChooseUs    WhyChooseUsItem[]
}
model JobApplication {
  id             Int       @id @default(autoincrement())
  name           String
  email          String
  role           String?
  notes          String?
  cvUrl          String?   // stored S3/public URL if uploaded
  fileName       String?   // original filename
  fileSize       Int?      // bytes
  mimetype       String?   // e.g. application/pdf
  userAgent      String?
  ip             String?
  idempotencyKey String?   @unique
  messageId      String?   @unique
  status         SubmissionStatus @default(PENDING)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  @@index([createdAt])
}

model PricingTier {
  id                        Int                  @id @default(autoincrement())
  pageId                    Int
  title                     String
  tagline                   String?
  taglineParts              String[]             @default([])
  rangeUsd                  Int[]                @default([])
  bullets                   String[]             @default([])
  highlight                 Boolean              @default(false)
  details                   String?
  assumptions               String[]             @default([])
  costBreakdown             Json?
  estimatedTimelineWeeks    Int[]                @default([])
  exampleScope              String?
  exclusions                String[]             @default([])
  paymentMilestones         Json?
  recommendedBudgetGuidance Json?
  typicalDeliverables       String[]             @default([])
  typicalTeam               Json?
  page                      PricingPage          @relation(fields: [pageId], references: [id])
  whyItems                  PricingTierWhyItem[]
}

model PricingTierWhyItem {
  id          String      @id @default(cuid())
  tierId      Int
  icon        String?
  title       String
  description String?
  order       Int         @default(0)
  tier        PricingTier @relation(fields: [tierId], references: [id], onDelete: Cascade)

  @@index([tierId])
}

model WhyChooseUsItem {
  id          Int         @id @default(autoincrement())
  pageId      Int
  icon        String?
  title       String
  description String
  order       Int         @default(0)
  page        PricingPage @relation(fields: [pageId], references: [id], onDelete: Cascade)
}

model PaymentMethod {
  id      Int         @id @default(autoincrement())
  pageId  Int
  label   String
  logoSrc String?
  order   Int         @default(0)
  page    PricingPage @relation(fields: [pageId], references: [id], onDelete: Cascade)
}

model QuickEstimate {
  id     Int         @id @default(autoincrement())
  pageId Int
  label  String
  low    Int
  high   Int
  note   String?
  page   PricingPage @relation(fields: [pageId], references: [id])
}
model Author {
  id         String     @id @default(cuid())
  name       String
  slug       String?    @unique
  avatarUrl  String?
  bio        String?
  posts      BlogPost[] @relation("AuthorPosts")
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt

  @@index([createdAt])
}
model BlogPost {
  id                           String    @id @default(cuid())
  slug                         String    @unique
  title                        String
  excerpt                      String?
  content                      String
  keywords                     String[]  @default([])
  tags                         String[]  @default([])
  readTime                     Int?
  featured                     Boolean   @default(false)
  draft                        Boolean   @default(true)
  publishedAt                  DateTime?
  seo                          Json?
  meta                         Json?
  
  createdAt                    DateTime  @default(now())
  updatedAt                    DateTime  @updatedAt
  cta                          Json?
  coverImageId                 String?   @unique
  legacyCoverImage             String?
  images                       Asset[]   @relation("PostAssets")
  coverImage                   Image?    @relation("CoverImage", fields: [coverImageId], references: [id])
  Image_Image_postIdToBlogPost Image[]   @relation("Image_postIdToBlogPost")
  authorId    String?   // nullable
  author      Author?   @relation("AuthorPosts", fields: [authorId], references: [id])
  @@index([createdAt])
  @@index([featured])
}

enum AssetStatus { 
  uploading 
  processing 
  ready 
  failed 
  
  }
model BookPilotSubmission {
  id             Int      @id @default(autoincrement())
  name           String
  email          String
  company        String
  userAgent      String?
  ip             String?
  idempotencyKey String?      @unique
  messageId      String?      @unique
  privacyConsent Boolean      @default(false)
  createdAt      DateTime     @default(now())
  deletedAt      DateTime?
  status         SubmissionStatus @default(PENDING)

  @@index([createdAt])
}



model Asset {
  id             String    @id @default(dbgenerated("gen_random_uuid()"))
  url            String
  key            String?
  originalname   String?
  alt            String?
  caption        String?
  width          Int?
  height         Int?
  size           Int?
  mimetype       String?
  role           String?
  order          Int?      @default(0)
  meta           Json?
  derivatives    Json?
  status         String?   @default("uploading")
  checksum       String?   @unique
  idempotencyKey String?   @unique
  createdAt      DateTime? @default(now()) @db.Timestamp(6)
  updatedAt      DateTime? @default(now()) @updatedAt @db.Timestamp(6)
  postId         String?
  uploadedBy     String?
  post           BlogPost? @relation("PostAssets", fields: [postId], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model Image {
  id                              String    @id
  url                             String
  key                             String?
  alt                             String?
  caption                         String?
  width                           Int?
  height                          Int?
  size                            Int?
  mimeType                        String?
  role                            String?
  blurhash                        String?
  focalPoint                      Json?
  order                           Int       @default(0)
  meta                            Json?
  createdAt                       DateTime  @default(now())
  postId                          String?
  uploadedBy                      String?
  coverOf                         BlogPost? @relation("CoverImage")
  BlogPost_Image_postIdToBlogPost BlogPost? @relation("Image_postIdToBlogPost", fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([role])
}

enum SocialKind {
  linkedin
  twitter
  instagram
  tiktok
}
enum SubmissionStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}